\documentclass[a4paper,11pt]{article}

\renewcommand\thesection{\arabic{section}.}

\usepackage[english]{babel}

\usepackage{tocloft}
\cftsetindents{section}{0em}{2em}
\cftsetindents{subsection}{0em}{2em}
\renewcommand\cfttoctitlefont{\hfill\Large\bfseries}
\renewcommand\cftaftertoctitle{\hfill\mbox{}}
\setcounter{tocdepth}{2}

\usepackage{listings}
\usepackage{xcolor}

\usepackage{fullpage}

\usepackage{float}

\usepackage{amsfonts}

\usepackage{sectsty}
\sectionfont{\fontsize{14}{15}\selectfont}

\usepackage{graphicx}
\usepackage[margin=0.6in,includefoot,headsep=0.1in]{geometry}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\cfoot{\thepage}
\rfoot{P. T. O.}
\lfoot{ROHIT DAS 30000114022}

\usepackage{booktabs}
\usepackage{tabularx}

\usepackage{verbatim}

%\usepackage{array}
%\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}

\usepackage{courier}
\usepackage{pdflscape}
\lstdefinestyle{SQL-Michalstyle}
{%
  language   = SQL,
  %caption    = {SQL query explained},
  basicstyle = \footnotesize ,
  columns    = fixed,
}

\lstset{
	style=SQL-Michalstyle,
	backgroundcolor=\color{black!5}, % set backgroundcolor
}

\usepackage{csvsimple, filecontents}

\newcommand*{\plogo}{\fbox{$\mathcal{PL}$}} % Generic publisher logo

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\newcommand*{\titleGM}{\begingroup % Create the command for including the title page in the document
\hbox{ % Horizontal box
\hspace*{0.18\textwidth} % Whitespace to the left of the title page
\rule{1pt}{\textheight} % Vertical line
\rule{1pt}{\textheight}
\hspace*{0.05\textwidth} % Whitespace between the vertical line and title page text
\parbox[b]{0.75\textwidth}{ % Paragraph box which restricts text to less than the width of the page

{\noindent\Huge\bfseries Database Management \\[0.5\baselineskip] System.}\\[2\baselineskip] % Title
{\large \textit{-supervised by:}\\\\\Large \textsc Prof. Kaushik Majumdar, \\\\ Prof. Mihir Singh, and\\\\Prof. Subhanjan Sarkar}\\[4\baselineskip] % Tagline or further description

{\huge \textsc{Rohit Das}} % Author name
{\\\\\Large{B. Tech(Computer Sc. and Engg)}\\\\\Large{Roll: 30000114022\\\\\Large{Regn. No.:143000110023}\\\\\Large{6th Semester,2016}}}
\vspace{120pt} % Whitespace between the title block and the publisher
\begin{figure}[H]
\hspace*{100pt}
\includegraphics[width=90pt,height=\textheight,keepaspectratio]{/home/mouri/Pictures/makaut.jpg}
\end{figure}
{\noindent \textit{\large{Maulana Abul Kalam Azad University of Technology,\\\\West Bengal.\\\\}}{\large \LaTeX} \hspace{5pt}2017}\\[\baselineskip] % Publisher and logo
}}
\endgroup}

\begin{document}
%\pagestyle{empty} % Removes page numbers
\thispagestyle{empty}
\titleGM % This command includes the title page

\iffalse
\title{\textbf{\Huge Maulana Abul Kalam Azad University of\\[10pt] Technology}}
\date{\vspace{-5ex}}
\maketitle
\begin{center}
\textbf{\LARGE{(DBMS Assignment)}}
\end{center}
\begin{figure}[H]
\centering
\includegraphics[width=350pt,height=\textheight,keepaspectratio]{/home/mouri/Pictures/makaut.jpg}
\end{figure}
\bigskip

\begin{flushright}
\underline{\textbf{\author{\Huge Rohit Das}}}\\
\textbf{\LARGE{
B. Tech(CSE),5th Year\\
Roll No.: 3000114022\\
Regn. No.: 143000110023\\
Taught by: Prof. Kaushik Majumdar/ Prof. Mihir Singh\\
}}
\end{flushright}
%\tableofcontents
%\begin{table}[htbp]
%\centering
\fi

\begin{center}
\LARGE\textbf{\underline{INDEX}}
\end{center}
\thispagestyle{empty}
\begin{tabular}{|c|p{0.48\linewidth}|c|c|c|}
\textbf{Sl. No.}&\textbf{Particulars}&\textbf{Date}&\textbf{Page No.}&\textbf{Signature}\\[5pt] \hline
\\1.&Program to calculate average of cricket players.& 28/9/16 & 3 &\\ \hline
\\2.&Program to calculate cost for consumer.& 28/9/16 & 4 &\\ \hline
\\3.&Program to display votes received in election.& 28/9/16 & 5 &\\ \hline
\\4.&Program for operation on array elements.& 19/10/16 & 6 &\\ \hline
\\5.&Program to calculate factorial of a number.& 19/10/16 & 7 &\\ \hline
\\6.&Program to calculate sum of series$1+22+32+42+...$.& 19/10/16 & 7 &\\ \hline
\\7.&Program to add values of Complex no. objects.& 9/11/16 & 8 &\\ \hline
\\8.&Program to convert distances to inches and add.& 28/9/16 & 9 &\\ \hline
\\9.&Program for String class with different costructors.& 9/11/16 & 10 &\\ \hline
\\10.&Program to display unique roll of Student objects.& 9/11/16 & 10 &\\ \hline
11.&Program to swap values of objects using 'friend' function.& 9/11/16 & 11 &\\ \hline
\\12.&Program for operation on matrices.& 16/11/16 & 12 &\\ \hline
13.&Program to use overloaded operators on float numbers.& 16/11/16 & 14 &\\ \hline
\\14.&Program to compare two strings by '==' operator.& 16/11/16 & 15 &\\ \hline
\\15.&Program to implement current and savings a/c.& 23/11/16 & 16 &\\ \hline
\\16.&Previous program rewritten using constructors.& 23/11/16 & 18 &\\ \hline
\\17.&Program for an educational institution.& 23/11/16 & 20 &\\ \hline
\\18.&Program to implement a network.& 23/11/16 & 23 &\\ \hline
\\19.&Program to show overriding using 'virtual'.& 30/11/16 & 24 &\\ \hline
\\20.&Program to implement Shape class using 'virtual'.& 30/11/16 & 25 &\\ \hline
\\21.&Previous program rewritten without using 'virtual'.& 30/11/16 & 26 &\\ \hline
\\22.&Program to use template for an array.& 7/12/16 & 27 &\\ \hline
23.&Program to implement exception handling with multiple catch.& 7/12/16 & 28 &\\ \hline
\\24.&Program to implement rethrowing an exception.& 7/12/16 & 29 &\\ \hline
\\25.&Program to implement a generic vector.& 27/12/16 & 29 &\\ \hline
\end{tabular}
%\end{table}

\section{Date: 20/4/2017}

\csvautotabular{/home/mouri/DBMS2/DBMS/Week3/ETeam.csv}
\LARGE{ETeam (PK: ID)}

\bigskip

\bigskip

\large{\csvautotabular{/home/mouri/DBMS2/DBMS/Week3/Game.csv}}
\LARGE{Game(PK:ID)}

\large{\csvautotabular{/home/mouri/DBMS2/DBMS/Week3/Goal.csv}}
\LARGE{Goal (FK: MATCHID)}

\subsection{Show player name, team id,stadium and 		mdate for every german player.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select Goal.Player,Goal.TeamID,Game.Stadium,Game.MDate
from Goal join Game on Goal.MATCHID=Game.ID
where goal.teamid='GER'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week3/q1.csv}
\end{figure}

\subsection{Show team1,team2, and player for every goal scored by a player called 'Mario'.}
\underline{Program:}
\begin{lstlisting}[showstringspaces=false]
select Game.team1, Game.team2, Goal.Player 
from Goal join Game on Goal.MATCHID=Game.ID
where goal.matchid=game.id and goal.player like 'Mario%'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week3/q2.csv}
\end{figure}
\bigskip


\subsection{Show player, teamid, coach, gtime for all goals scored in the first 10 minutes.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select Goal.Player, Goal.TeamID,eteam.coach,goal.gtime 
from Goal join eteam on Goal.teamID=ETeam.ID
where goal.gtime <= 10
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week3/q3.csv}
\end{figure}
.


\subsection{List the dates of the matches and the name of the team in which 'Fernando Santos' was the team1 coach.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select Game.mdate, ETeam.teamname 
from Game join eteam on Game.Team1=ETeam.ID
where coach='Fernando Santos'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week3/q4.csv}
\end{figure}
\bigskip


\subsection{List the player for every goal scored in a game  whre the stadium was 'National Stadium, Warsaw'.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select Goal.player
from Game join goal on Goal.matchid=game.ID
where stadium='National Stadium, Warsaw'

\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week3/q5.csv}
\end{figure}
\bigskip


\subsection{Show the name of the player who scored a goal against Germany('GER').}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select goal.player from goal
join game on goal.matchid=game.id
where (game.team2='GER' or game.team1='GER') and goal.teamid!='GER'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week3/q6.csv}
\end{figure}


\subsection{Show the stadium and the number of goals scored in each stadium. Use count().}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select game.stadium,count(*) as goal_count from game
join goal on goal.matchid=game.id
group by game.stadium
order by count(*) asc
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week3/q7.csv}
\end{figure}
.

\section{Date: 27/4/2017}

\large{\csvautotabular{/home/mouri/DBMS2/DBMS/Week4/ETeam.csv}}
\LARGE{ETeam (PK: ID)}

.

.

\large{\csvautotabular[filter={\value{csvrow}<5}]{/home/mouri/DBMS2/DBMS/Week4/Game.csv}}
\LARGE{Game(PK:ID)}

% count rows
\csvreader{/home/mouri/DBMS2/DBMS/Week4/Game.csv}{}{}%
\edef\totalrows{\thecsvrow}
\large{\csvautotabular[filter={
      \(\thecsvinputline>6\)
 \and \(\thecsvinputline<\numexpr\totalrows-1\relax\)
}]
{/home/mouri/DBMS2/DBMS/Week4/Game.csv}}

.

.

\large{\csvautotabular[filter={\value{csvrow}<23}]{/home/mouri/DBMS2/DBMS/Week4/Goal.csv}}
\LARGE{Goal (FK: MATCHID)}

\csvreader{/home/mouri/DBMS2/DBMS/Week4/Goal.csv}{}{}%
\edef\totalrows{\thecsvrow}
\large{\csvautotabular[filter={
      \(\thecsvinputline>24\)
 \and \(\thecsvinputline<\numexpr\totalrows-1\relax\)
}]
{/home/mouri/DBMS2/DBMS/Week4/Goal.csv}}

\subsection{Show the matchdate,stadium,player name,goal time for match ids 1019 and 1021.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select game.mdate,game.stadium,goal.player, goal.gtime 
from Game left join goal 
on Goal.matchid=game.id
where game.id=1019 or game.id=1021
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week4/q1.csv}
\end{figure}
.

\subsection{Show all the goal time,player, stadium where first team was Germany.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select goal.gtime,goal.player,game.stadium  
from Game left join goal 
on Goal.matchid=game.id
where game.team1='GER'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week4/q2.csv}
\end{figure}
.
\subsection{Show the matchdate,stadium,teamname where Diego Maradona was the coach. Use right join.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select game.mdate,game.stadium,eteam.teamname
from Game right join eteam 
on game.team1=eteam.id or game.team2=eteam.id
where eteam.coach='Diego Maradona'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week4/q3.csv}
\end{figure}
.

\subsection{Show id,matchdate,stadium,coach and team name for all team2. Use full outer join.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select distinct game.id,game.mdate,game.stadium,eteam.coach,eteam.teamname
from Game full outer join eteam 
on game.team2=eteam.id
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular[filter={\value{csvrow}<5}]{/home/mouri/DBMS2/DBMS/Week4/q4.csv}
\end{figure}

\bigskip
\bigskip

\section{Date: 27/4/2017}
\csvautotabular{/home/mouri/DBMS2/DBMS/Week4/order.csv}
\bigskip

\LARGE{Order (PK:ORDER-ID, FK:CUSTOMER-ID)}

\bigskip

\large{\csvautotabular{/home/mouri/DBMS2/DBMS/Week4/customer.csv}}
\bigskip

\LARGE{Game(PK:CUSTOMER-ID)}

\bigskip
\bigskip

\large{\csvautotabular{/home/mouri/DBMS2/DBMS/Week4/employee.csv}}
\LARGE{Employee (PK: EMPID)}

\subsection{Show employee name and Manager name for Employee ID 4 and 6.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select b.name as Employee, a.name as Manager 
from employee a,employee b
where a.empid=b.manager and (b.empid=4 or b.empid=6)
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week4/q5.csv}
\end{figure}
.

\subsection{Show the entire list of employee name and employee id under manager "Palash Roy".}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select distinct emp.name as Employee, man.name as Manager 
from employee emp,employee man
where emp.manager=man.empid and man.empid=4
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week4/q6.csv}
\end{figure}

\bigskip
\bigskip
\section{Date: 4/5/2017}
\large{\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/clnt-mast.csv}}
\bigskip

\LARGE{Client\_Master (PK:Client-No)}

\bigskip

\bigskip

\footnotesize{\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/prod-mast.csv}}

\bigskip
\LARGE{Product\_Master  (PK:Product-No)}

\bigskip
\large{\csvautotabular[filter={\value{csvrow}<32}]{/home/mouri/DBMS2/DBMS/Week5/sal-ord.csv}}

\bigskip
\LARGE{Sales\_Order (PK: Order-No, FK: Client-No)}

\bigskip

\bigskip
\subsection{Retrieve the list of names, city and the states of all the clients.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select name, city, state from client_master
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q1.csv}
\end{figure}
\bigskip

\subsection{List all the clients who are located in Mumbai.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select name from client_master
where city='Mumbai'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
%\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q2.csv}
\end{figure}
\bigskip

\subsection{List the various products available from the PRODUCT-MASTER table.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select description from product_master
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q3.csv}
\end{figure}
\bigskip

\subsection{Change the city of Client\_No 'C00005' to Bangalore.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
update client_master
set city='Bangalore'
where client_no='C00005'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q4.csv}
\end{figure}
\bigskip

\subsection{Add a column called 'Telephone' of datatype 'number' and size='10' to the Client\_Master table.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
alter table client_master
add Telephone number(10)
\end{lstlisting}
Output:
\begin{figure}[H]
\centering

\end{figure}
\bigskip

\subsection{Delete the column 'Telephone'.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
alter table client_master
drop column Telephone
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\verbatiminput{/home/mouri/DBMS2/DBMS/Week5/q6.txt}
\end{figure}
\bigskip

\subsection{Change the name of Client\_Master to Clnt\_Mast.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
rename client_master to clnt_mast
\end{lstlisting}
Output:
\begin{figure}[H]
\centering

\end{figure}
\bigskip

\subsection{List the names of all clients having 'a' letter in their names.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select name from clnt_mast
where name like '%a%'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q9.csv}
\end{figure}
\bigskip

\subsection{List the names of the clients who stay in 'Bangalore' or 'Mangalore'.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select name from clnt_mast
where city like '_angalore'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q10.csv}
\end{figure}
\bigskip

\subsection{List the names of the clients having 'h' as the second letter in their names.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select name from clnt_mast
where name like '_h%'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q11.csv}
\end{figure}
\bigskip

\subsection{List all the information from the Sales\_Order table for orders placed in the month of June.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select * from sales_order
where order_date like '%JUN%'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q12.csv}
\end{figure}
\bigskip

\subsection{List the information for Client\_No 'C00001' and 'C00002'.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select * from sales_order
where client_no='C00001' or client_no='C00002'
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q13.csv}
\end{figure}
\bigskip

\subsection{List products whose selling price is greater than 500 and less than 700.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select * from product_master
where sell_price > 500 and sell_price < 700
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q14.csv}
\end{figure}
\bigskip

\subsection{List the names, city and states of clients who are not in the state of 'Maharashtra'.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select name,city,state from clnt_mast
where state <> 'Maharashtra'

\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q15.csv}
\end{figure}
\bigskip

\subsection{List the products whose selling price is more than 500. Calculate a new selling price as, original selling price * 15. Rename the new column in the output of the above query as New\_Price.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select description, sell_price*15 as new_price 
from product_master
where sell_price > 500
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\footnotesize{\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q16.csv}}
\end{figure}
\bigskip
\subsection{Count the number of products having sell\_price less than or equal to 500.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select count(sell_price) from product_master
where sell_price < = 500
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q18.csv}
\end{figure}
\bigskip
\subsection{List the order number and day on which clients placed their order.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select name,order_no,order_date,to_char(to_date(order_date,'dd/mm/yyyy'), 'DY') as day
from sales_order join clnt_mast on clnt_mast.client_no=sales_order.client_no
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q19.csv}
\end{figure}
\bigskip

\section{Date: 4/5/2017}

(Refer to tables on pages 7,8 and 9)

\subsection{Show the stadium and the number of goals scored in each stadium. For every match where 'GER' scored, show matchid, match date and the number of goals scored by 'GER'.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select matchid,mdate,count(*)
from game join goal 
on goal.matchid=game.id
where teamid='GER'
group by mdate,matchid
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week5/q19.csv}
\end{figure}
\bigskip

\section{Date: 11/5/2017}
\large{\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/teach.csv}}
\LARGE{Teacher (PK: ID)}

\bigskip

\bigskip

\large{\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/dept.csv}}
\LARGE{Dept (PK: ID)}

\bigskip

\bigskip

\subsection{List the teachers who have NULL for their department.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select name from teacher
where dept is null
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/q1.csv}
\end{figure}
\bigskip

\subsection{Show teacher name and dept. name for teachers having not null in dept.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select teacher.name, dept.name as dept
from teacher join dept on teacher.dept=dept.id
where teacher.dept is not null
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/q2.csv}
\end{figure}
\bigskip

\subsection{Show teachers name, id, mobile and dept name.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select teacher.name, teacher.id, teacher.mobile, dept.name 
from dept full outer join teacher on teacher.dept=dept.id
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/q3.csv}
\end{figure}
\bigskip

\subsection{Use a different JOIN so that all teachers are listed.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select teacher.name, teacher.id, dept.name 
from dept right outer join teacher on teacher.dept=dept.id
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/q4.csv}
\end{figure}
\bigskip

\subsection{Use a different JOIN so that all departments are listed.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select teacher.name, teacher.id, dept.name 
from dept left outer join teacher on teacher.dept=dept.id
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/q5.csv}
\end{figure}
\bigskip

\subsection{Use COALESCE to print the mobile number. Use the number '07986 444 2266' if there is no number given. Show teacher name and mobile number or '07986 444 2266'}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select name,
coalesce (mobile,'07986 444 2266') as newmob
from teacher
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/q6.csv}
\end{figure}
\bigskip

\subsection{Use the COALESCE function and a LEFT JOIN to print the teacher name and department name. Use the string 'None' where there is no department.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select teacher.name, coalesce(dept.name,'None') as dept
from teacher left join dept on teacher.dept=dept.id
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/q7.csv}
\end{figure}
\bigskip

\subsection{Use COUNT to show the number of teachers and the number of mobile phones.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select count(name) as Total_Teachers,
count(mobile) as Total_Mobiles 
from teacher
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/q8.csv}
\end{figure}
\bigskip

\subsection{Use COUNT and GROUP BY dept.name to show each department and the number of staff. Use a RIGHT JOIN to ensure that the Engineering department is listed.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select dept.name, count(teacher.name) as Total_staff
from teacher right join dept on teacher.dept=dept.id
group by dept.name
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/q9.csv}
\end{figure}
\bigskip

\subsection{Use CASE to show the name of each teacher followed by 'Sci' if the teacher is in dept 1 or 2 and 'Art' otherwise.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select name,
case when dept=1 or dept=2 then 'Sci'
else 'Art'
end as Dept
from teacher
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/q10.csv}
\end{figure}
\smallskip

\subsection{Use CASE to show the name of each teacher followed by 'Sci' if the teacher is in dept 1 or 2, show 'Art' if the teacher's dept is 3 and 'None' otherwise.}
\underline{Query:}
\begin{lstlisting}[showstringspaces=false]
select name,
case when dept=1 or dept=2 then 'Sci'
when dept=3 then 'Art'
else 'None'
end as Dept
from teacher
\end{lstlisting}
Output:
\begin{figure}[H]
\centering
\csvautotabular{/home/mouri/DBMS2/DBMS/Week6/q11.csv}
\end{figure}


\end{document}